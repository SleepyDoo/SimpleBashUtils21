#include <stdio.h>#include <getopt.h>#include "s21_cat.h"int main(int argc, char * argv[]) {    extern int optind;    opt options = {0};    parser(argc, argv, &options);    int f_counter = 0;    if(options.v || options.e || options.n || options.t || options.b || options.s) {        while (f_counter < argc - 2) {            reader(argv, options, f_counter);            f_counter++;        }    } else if (argc > 1) {        while (f_counter < argc - 1) {            reader(argv, options, f_counter);            f_counter++;        }    }    return 0;}void reader(char ** argv, opt options, int f_counter) {        int str_counter = 0;        int s_counter = 1;        int b_flag = 0;        int n_flag = 0;        FILE * file;        file = fopen(argv[optind + f_counter], "r");        if (file) {            int cur;            while ((cur = fgetc(file)) != EOF) {                int flag = 1;                if (options.s) {                    if (cur == '\n') {                        ++s_counter;                    } else {                        s_counter = 0;                    }                    if (s_counter > 2) {                        flag = 0;                    } else {                        flag = 1;                    }                }                if (options.e && !options.v) {                    if (cur == '\n') {                        flag = 0;                        printf("$\n");                    } else {                        flag = 1;                    }                }                if (options.b) {                    if (cur != '\n') {                        if (b_flag == 0) {                            printf("%6d\t", ++str_counter);                            b_flag = 1;                        }                    } else {                        b_flag = 0;                    }                }                if (options.n && flag) {                    if (n_flag == 0) {                        n_flag = 1;                    }                    if (n_flag == 1) {                        printf("%6d\t", ++str_counter);                        n_flag = -1;                    }                    if (cur == '\n') {                        n_flag = 0;                    }                }                if (options.t && !options.v) {                    if (cur == '\t') {                        flag = 0;                        printf("^I");                    } else {                        flag = 1;                    }                }                if (options.v) {                    if (cur == '\t' && options.t) {                        flag = 0;                        printf("^I");                    } else if (cur == '\n' && options.e) {                        flag = 0;                        printf("$\n");                    } else if (!(((cur > 31) && (cur < 127) ) || cur == 10 || cur == 9)) {                        flag = 0;                        printf("%s", table[cur]);                    }                }                if (((cur > 31) && (cur < 127)) || cur != 10 || cur != 9) {                    if (flag) {                        printf("%c", cur);                    }                }            }            fclose(file);        } else {            printf("ERROR! No such file\n");        }    }void parser(int argc, char ** argv, opt * options) {    int opt = 0;    int opt_index = 0;    while (opt != -1) {        opt = getopt_long(argc, argv, "benstvTE", longopts, &opt_index);        if (opt != -1) {            switch (opt) {                case 'b':                    options->b = 1;                    break;                case 'e':                options->e = 1;                options->v = 1;                break;                case 'n':                options->n = 1;                break;                case 's':                options->s = 1;                break;                case 't':                options->t = 1;                options->v = 1;                break;                case 'v':                options->v = 1;                break;                case 'E':                options->e = 1;                break;                case 'T':                options->t = 1;                break;                default: fprintf(stderr, "error in flags\n");            }            if (options->b && options->n) {                options->n = 0;            }        }    }}